---
layout: page
title: ... in oroGen
section: Data Processing
---
<div class="content2">
<div class="content2-pagetitle">  ... in oroGen</div>
<div class="content2-container line-box">
<div class="content2-container-1col">


                <p>To make life easier while using the stream aligner, an oroGen plug-in was
created. Using this plugin, the laser filter that we outlined in the previous
pages would be declared with:</p>

<pre><code class="language-ruby">task_context "Task" do
input_port "lidar_samples", "/base/samples/LaserScan"
input_port "transformation", "/base/samples/RigidBodyState"
output_port "filtered_samples", "/base/samples/LaserScan"

stream_aligner do
  max_latency 0.5
  align_port "lidar_samples", 0
  align_port "transformation", 0
end

port_driven
end
</code></pre>

<p>The usage of this plugin requires the drivers/orogen/aggregator package. The
project&rsquo;s manifest.xml must therefore contain:</p>

<pre><code class="language-xml">&lt;depend package="drivers/orogen/aggregator" /&gt;
</code></pre>

<p>The following statements are available in the task context definition:</p>

<dl>
<dt>stream_aligner</dt>
<dd>The stream_aligner statement will add a instance of the stream aligner to the
task base class. If needed, this instance of aggregator::StreamAligner (from
<a href="/pkg/drivers/aggregator/index.html">the drivers/aggregator package</a>) can be accessed
from the C++ code as the _stream_aligner attribute.</dd>
<dt>max_latency(timeout_in_seconds)</dt>
<dd>The max_latency statement sets the timeout of the stream aligner. It can be
overriden through a generated aggregator_max_latency property on the task.</dd>
<dt>align_port(name, period)</dt>
<dd>Registers a stream on the task&rsquo;s stream aligner, and pushes all the data that
arrives on the specified port to this stream. The provided period is the
<em>default period</em> for the stream. It can be overriden at runtime by setting a
generated property called &ldquo;port_name&rdquo;_period (e.g. lidar_samples_period for
the lidar_samples stream)</dd>
</dl>

<p>In the C++ task, for each stream declared with align_port, a C++ callback
method, of the form &ldquo;void stream_nameCallback(timestamp, sample)&rdquo; is generated.</p>

<pre><code class="language-cpp">void lidar_samplesCallback(base::Time const&amp; timestamp,
  base::samples::LaserScan const&amp; sample)
{
// process the sample
}
</code></pre>

<p>As usual with oroGen, if you add or remove streams after the first code
generation, you must update the files in tasks/ yourself, using if needed the
templates generated in templates/tasks/</p>

<p class="warning">Your task implementation MUST call TaskBase::configureHook() and
TaskBase::updateHook() if you reimplement the hooks. The hook code generated by
default by oroGen does this already.</p>

<p>The next page will now deal on the usage, at runtime, of a component that is
using the stream aligner as well as its online and offline monitoring.</p>



</div>
</div>
</div>
